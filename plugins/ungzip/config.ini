[general]
_version={{MFMODULE_VERSION}}
_summary=plugin which ungzip incoming files and reinject them into the switch plugin
_license=BSD
_url=http://metwork
_maintainer=Fabien MARTY <fabien.marty@gmail.com>
_vendor=MetWork

[step_main]
cmd_and_args = {{MFDATA_CURRENT_PLUGIN_DIR}}/main.py --config-file={{MFDATA_CURRENT_CONFIG_INI_PATH}} --redis-unix-socket-path={{MFMODULE_RUNTIME_HOME}}/var/redis.socket {{MFDATA_CURRENT_STEP_QUEUE}}

# Directory in which decompressed files will be reinjected.
# By default, decompressed files are reinjected in the switch. Therefore, make
# sure you have a plugin actually using the decompressed files, otherwise, they
# will be moved to the trash.
_arg_dest-dir = {{MFDATA_DATA_IN_DIR}}/step.switch.main

numprocesses = 1
timeout = 30

_switch_logical_condition = ( x['latest.switch.main.system_magic'].startswith(b'gzip compressed data') )
_switch_use_hardlink = True
